{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import'./cart.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CartPage(_ref){let{cart,onRemoveFromCart}=_ref;const navigate=useNavigate();const[errorMessage,setErrorMessage]=useState('');const[isLoading,setIsLoading]=useState(false);const calculateTotal=()=>{return cart.reduce((acc,item)=>acc+item.quantity*item.price,0);};const handleValidation=async()=>{if(cart.length>0){setIsLoading(true);try{const orderData={items:cart,totalPrice:calculateTotal()};console.log(\"Données de commande envoyées:\",orderData);// Ajouter un log pour vérifier les données envoyées\nconst response=await axios.post('http://localhost:5000/order',orderData);console.log(\"Réponse du serveur:\",response.data);// Vérifier la réponse du backend\n// Redirection\nnavigate('/delivery');}catch(error){console.error('Erreur lors de la validation du panier:',error);setErrorMessage('Une erreur est survenue. Veuillez réessayer.');}setIsLoading(false);}else{setErrorMessage('Votre panier est vide. Ajoutez des articles avant de valider la commande.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"cart-page\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>navigate(-1),children:\"Retour\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Votre Panier\"}),/*#__PURE__*/_jsx(\"div\",{id:\"cart-items\",children:cart.length>0?cart.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:item.imgSrc,alt:item.name,className:\"cart-item-image\"}),/*#__PURE__*/_jsx(\"span\",{className:\"cart-item-name\",children:item.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"cart-item-quantity\",children:[\"Quantit\\xE9: \",item.quantity]}),/*#__PURE__*/_jsxs(\"span\",{className:\"cart-item-price\",children:[\"Prix unitaire: \",item.price,\"FCFA\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"cart-item-total\",children:[\"Total: \",item.quantity*item.price,\"FCFA\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>onRemoveFromCart(item.id),className:\"remove-button\",children:\"Supprimer\"})]},index)):/*#__PURE__*/_jsx(\"p\",{children:\"Votre panier est vide\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-summary\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"total-general\",children:[\"Total G\\xE9n\\xE9ral (\",cart.length,\" articles) = \",calculateTotal(),\"FCFA\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"validate-button\",onClick:handleValidation,disabled:isLoading,children:isLoading?'Validation en cours...':'Valider'})]}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMessage})]});}export default CartPage;","map":{"version":3,"names":["React","useState","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","CartPage","_ref","cart","onRemoveFromCart","navigate","errorMessage","setErrorMessage","isLoading","setIsLoading","calculateTotal","reduce","acc","item","quantity","price","handleValidation","length","orderData","items","totalPrice","console","log","response","post","data","error","className","children","onClick","id","map","index","src","imgSrc","alt","name","disabled"],"sources":["/home/fathane/link_repository/frontend/src/components/CartPage.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport './cart.css';\n\nfunction CartPage({ cart, onRemoveFromCart }) {\n    const navigate = useNavigate();\n    const [errorMessage, setErrorMessage] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n\n    const calculateTotal = () => {\n        return cart.reduce((acc, item) => acc + item.quantity * item.price, 0);\n    };\n\n    const handleValidation = async () => {\n        if (cart.length > 0) {\n            setIsLoading(true);\n            try {\n                const orderData = {\n                    items: cart,\n                    totalPrice: calculateTotal(),\n                };\n                console.log(\"Données de commande envoyées:\", orderData); // Ajouter un log pour vérifier les données envoyées\n   \n                const response = await axios.post('http://localhost:5000/order', orderData);\n                console.log(\"Réponse du serveur:\", response.data); // Vérifier la réponse du backend\n   \n                // Redirection\n                navigate('/delivery');\n            } catch (error) {\n                console.error('Erreur lors de la validation du panier:', error);\n                setErrorMessage('Une erreur est survenue. Veuillez réessayer.');\n            }\n            setIsLoading(false);\n        } else {\n            setErrorMessage('Votre panier est vide. Ajoutez des articles avant de valider la commande.');\n        }\n    };\n   \n\n    return (\n        <div className=\"cart-page\">\n            <button className=\"back-button\" onClick={() => navigate(-1)}>Retour</button>\n            \n            <h2>Votre Panier</h2>\n            <div id=\"cart-items\">\n                {cart.length > 0 ? (\n                    cart.map((item, index) => (\n                        <div key={index} className=\"cart-item\">\n                            <img src={item.imgSrc} alt={item.name} className=\"cart-item-image\" />\n                            <span className=\"cart-item-name\">{item.name}</span>\n                            <span className=\"cart-item-quantity\">Quantité: {item.quantity}</span>\n                            <span className=\"cart-item-price\">Prix unitaire: {item.price}FCFA</span>\n                            <span className=\"cart-item-total\">Total: {item.quantity * item.price}FCFA</span>\n                            <button onClick={() => onRemoveFromCart(item.id)} className=\"remove-button\">\n                                Supprimer\n                            </button>\n                        </div>\n                    ))\n                ) : (\n                    <p>Votre panier est vide</p>\n                )}\n            </div>\n            <div className=\"cart-summary\">\n                <span className=\"total-general\">Total Général ({cart.length} articles) = {calculateTotal()}FCFA</span>\n                <button className=\"validate-button\" onClick={handleValidation} disabled={isLoading}>\n                    {isLoading ? 'Validation en cours...' : 'Valider'}\n                </button>\n            </div>\n\n            {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n        </div>\n    );\n}\n\nexport default CartPage;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEpB,QAAS,CAAAC,QAAQA,CAAAC,IAAA,CAA6B,IAA5B,CAAEC,IAAI,CAAEC,gBAAiB,CAAC,CAAAF,IAAA,CACxC,KAAM,CAAAG,QAAQ,CAAGV,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACW,YAAY,CAAEC,eAAe,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACc,SAAS,CAAEC,YAAY,CAAC,CAAGf,QAAQ,CAAC,KAAK,CAAC,CAEjD,KAAM,CAAAgB,cAAc,CAAGA,CAAA,GAAM,CACzB,MAAO,CAAAP,IAAI,CAACQ,MAAM,CAAC,CAACC,GAAG,CAAEC,IAAI,GAAKD,GAAG,CAAGC,IAAI,CAACC,QAAQ,CAAGD,IAAI,CAACE,KAAK,CAAE,CAAC,CAAC,CAC1E,CAAC,CAED,KAAM,CAAAC,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAIb,IAAI,CAACc,MAAM,CAAG,CAAC,CAAE,CACjBR,YAAY,CAAC,IAAI,CAAC,CAClB,GAAI,CACA,KAAM,CAAAS,SAAS,CAAG,CACdC,KAAK,CAAEhB,IAAI,CACXiB,UAAU,CAAEV,cAAc,CAAC,CAC/B,CAAC,CACDW,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAEJ,SAAS,CAAC,CAAE;AAEzD,KAAM,CAAAK,QAAQ,CAAG,KAAM,CAAA3B,KAAK,CAAC4B,IAAI,CAAC,6BAA6B,CAAEN,SAAS,CAAC,CAC3EG,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAEC,QAAQ,CAACE,IAAI,CAAC,CAAE;AAEnD;AACApB,QAAQ,CAAC,WAAW,CAAC,CACzB,CAAE,MAAOqB,KAAK,CAAE,CACZL,OAAO,CAACK,KAAK,CAAC,yCAAyC,CAAEA,KAAK,CAAC,CAC/DnB,eAAe,CAAC,8CAA8C,CAAC,CACnE,CACAE,YAAY,CAAC,KAAK,CAAC,CACvB,CAAC,IAAM,CACHF,eAAe,CAAC,2EAA2E,CAAC,CAChG,CACJ,CAAC,CAGD,mBACIP,KAAA,QAAK2B,SAAS,CAAC,WAAW,CAAAC,QAAA,eACtB9B,IAAA,WAAQ6B,SAAS,CAAC,aAAa,CAACE,OAAO,CAAEA,CAAA,GAAMxB,QAAQ,CAAC,CAAC,CAAC,CAAE,CAAAuB,QAAA,CAAC,QAAM,CAAQ,CAAC,cAE5E9B,IAAA,OAAA8B,QAAA,CAAI,cAAY,CAAI,CAAC,cACrB9B,IAAA,QAAKgC,EAAE,CAAC,YAAY,CAAAF,QAAA,CACfzB,IAAI,CAACc,MAAM,CAAG,CAAC,CACZd,IAAI,CAAC4B,GAAG,CAAC,CAAClB,IAAI,CAAEmB,KAAK,gBACjBhC,KAAA,QAAiB2B,SAAS,CAAC,WAAW,CAAAC,QAAA,eAClC9B,IAAA,QAAKmC,GAAG,CAAEpB,IAAI,CAACqB,MAAO,CAACC,GAAG,CAAEtB,IAAI,CAACuB,IAAK,CAACT,SAAS,CAAC,iBAAiB,CAAE,CAAC,cACrE7B,IAAA,SAAM6B,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAEf,IAAI,CAACuB,IAAI,CAAO,CAAC,cACnDpC,KAAA,SAAM2B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,EAAC,eAAU,CAACf,IAAI,CAACC,QAAQ,EAAO,CAAC,cACrEd,KAAA,SAAM2B,SAAS,CAAC,iBAAiB,CAAAC,QAAA,EAAC,iBAAe,CAACf,IAAI,CAACE,KAAK,CAAC,MAAI,EAAM,CAAC,cACxEf,KAAA,SAAM2B,SAAS,CAAC,iBAAiB,CAAAC,QAAA,EAAC,SAAO,CAACf,IAAI,CAACC,QAAQ,CAAGD,IAAI,CAACE,KAAK,CAAC,MAAI,EAAM,CAAC,cAChFjB,IAAA,WAAQ+B,OAAO,CAAEA,CAAA,GAAMzB,gBAAgB,CAACS,IAAI,CAACiB,EAAE,CAAE,CAACH,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,WAE5E,CAAQ,CAAC,GARHI,KASL,CACR,CAAC,cAEFlC,IAAA,MAAA8B,QAAA,CAAG,uBAAqB,CAAG,CAC9B,CACA,CAAC,cACN5B,KAAA,QAAK2B,SAAS,CAAC,cAAc,CAAAC,QAAA,eACzB5B,KAAA,SAAM2B,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAC,uBAAe,CAACzB,IAAI,CAACc,MAAM,CAAC,eAAa,CAACP,cAAc,CAAC,CAAC,CAAC,MAAI,EAAM,CAAC,cACtGZ,IAAA,WAAQ6B,SAAS,CAAC,iBAAiB,CAACE,OAAO,CAAEb,gBAAiB,CAACqB,QAAQ,CAAE7B,SAAU,CAAAoB,QAAA,CAC9EpB,SAAS,CAAG,wBAAwB,CAAG,SAAS,CAC7C,CAAC,EACR,CAAC,CAELF,YAAY,eAAIR,IAAA,MAAG6B,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAEtB,YAAY,CAAI,CAAC,EAC/D,CAAC,CAEd,CAEA,cAAe,CAAAL,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}